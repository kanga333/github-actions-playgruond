name: Check Actions

on:
  pull_request:

jobs:
  test_hider:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/github-script@0.9.0
      with:
        github-token: ${{ secrets.GITHUB_TOKEN }}
        script: |
          const output = `${{ steps.cicd.outputs.stdout }}`;
          github.issues.createComment({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: output
          })
    - uses: kanga333/comment-hider@master
      name: Hide bot comments
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
  test_variable_mapper:
    runs-on: ubuntu-latest
    steps:
    - uses: kanga333/variable-mapper@master
      with:
        key: "${{github.base_ref}}"
        map: |
          {
            "master": {
              "environment": "production"
            },
            "staging": {
              "environment": "staging"
            },
            ".*": {
              "environment": "development"
            }
          }
    - name: Echo environment
      run: echo ${{ env.environment }}
  test_json_array_builder:
    runs-on: ubuntu-latest
    steps:
    - uses: kanga333/json-array-builder@main
        id: array
        with:
          cmd: ls .github/workflows
          separator: newline
    - name: Echo environment
      run: echo ${{ steps.array.outputs.build }}
